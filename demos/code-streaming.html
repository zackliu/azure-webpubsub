<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-code_stream">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Code stream | Demos for Azure Web PubSub</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://azure.github.io/azure-webpubsub/demos/code-streaming"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="websocket, serverless, azure, web pubsub, service, realtime, messaging"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Code stream | Demos for Azure Web PubSub"><meta data-rh="true" name="description" content="Real-time collaborative code editor"><meta data-rh="true" property="og:description" content="Real-time collaborative code editor"><link data-rh="true" rel="icon" href="/azure-webpubsub/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://azure.github.io/azure-webpubsub/demos/code-streaming"><link data-rh="true" rel="alternate" href="https://azure.github.io/azure-webpubsub/demos/code-streaming" hreflang="en"><link data-rh="true" rel="alternate" href="https://azure.github.io/azure-webpubsub/demos/code-streaming" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/azure-webpubsub/blog/rss.xml" title="Demos for Azure Web PubSub RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/azure-webpubsub/blog/atom.xml" title="Demos for Azure Web PubSub Atom Feed">





<script async src="https://wcpstatic.microsoft.com/mscc/lib/v2/wcp-consent.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9DVQRCY9L7"></script>
<script>function gtag(){dataLayer.push(arguments)}function gtagInit(){gtag("js",new Date),gtag("config","G-9DVQRCY9L7",{anonymize_ip:!0})}window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n,r){e[n]=e[n]||[];var o=t.getElementsByTagName(a)[0],c=t.createElement(a);c.async=!0,c.src="https://www.googletagmanager.com/gtm.js?id=GTM-N67NT6N",o.parentNode.insertBefore(c,o)}(window,document,"script","dataLayer")</script><link rel="stylesheet" href="/azure-webpubsub/assets/css/styles.8be63572.css">
<link rel="preload" href="/azure-webpubsub/assets/js/runtime~main.22eee77c.js" as="script">
<link rel="preload" href="/azure-webpubsub/assets/js/main.5bbe748c.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/azure-webpubsub/"><div class="navbar__logo"><img src="/azure-webpubsub/img/azure_logo.png" alt="Azure Web PubSub Service" class="themedImage_ToTc themedImage--light_HNdA custom-navbar-logo-class"><img src="/azure-webpubsub/img/azure_logo.png" alt="Azure Web PubSub Service" class="themedImage_ToTc themedImage--dark_i4oU custom-navbar-logo-class"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/azure-webpubsub/demos/chat">Demos</a><a class="navbar__item navbar__link" href="/azure-webpubsub/blog">Blog</a><a class="navbar__item navbar__link" href="/azure-webpubsub/contact_us">Contact Us</a></div><div class="navbar__items navbar__items--right"><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/azure-webpubsub/demos/chat">Simple chat app</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/azure-webpubsub/demos/whiteboard">Collaborative whiteboard</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/azure-webpubsub/demos/scoreboard">Real-time scoreboard</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/azure-webpubsub/demos/metaverse">Metaverse</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/azure-webpubsub/demos/code-streaming">Code stream</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/azure-webpubsub/demos/chatr">Chatr</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/azure-webpubsub/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Code stream</span><meta itemprop="position" content="1"></li></ul></nav><div class="theme-doc-markdown markdown"><div><div class="pattern-dots-sm mb-10 relative"><p class="bg-red-100 py-2 text-center font-bold text-red-900">To see streaming as you code, open the link in another tab.</p><div class="flex flex-col items-center w-full py-4 drop-shadow-xl xl:flex-row"><iframe src="https://awps-demos-codestream.azurewebsites.net/" title="Real-time chat app demo" class="h-[400px] w-[95%] xl:h-[600px]"></iframe></div><div class="flex flex-col xl:flex-row xl:items-center xl:justify-around mt-8"><a href="https://github.com/Azure/azure-webpubsub/tree/main/samples/javascript/codestream" target="_blank" class="absolute bottom-4 flex items-center font-semibold justify-center rounded-sm bg-blue-600 px-5 py-2 text-sm text-gray-100 hover:bg-blue-700 gap-2" tabindex="0" aria-label="" role="button"><div class="w-5"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2048 2048" class="lightIcon"><path d="M1024 25q141 0 272 36t244 104 207 160 161 207 103 245 37 272q0 165-50 318t-143 281-221 224-286 149q-3 1-9 1t-9 1q-24 0-38-14t-14-37v-140q0-69 1-141 0-51-15-103t-54-87q116-13 203-47t146-96 88-150 30-212q0-78-26-147t-79-128q11-28 16-58t5-60q0-39-8-77t-23-76q-5-2-11-2t-11 0q-32 0-67 10t-69 26-67 35-57 36q-125-35-256-35t-256 35q-25-17-57-36t-66-34-70-26-67-11h-11q-6 0-11 2-14 37-22 75t-9 78q0 30 5 60t16 58q-53 58-79 127t-26 148q0 122 29 211t88 150 146 97 203 48q-29 26-44 62t-21 75q-27 13-57 20t-60 7q-64 0-106-30t-75-82q-12-19-29-38t-37-34-43-24-48-10h-12q-8 0-15 3t-14 6-6 10q0 12 14 23t23 18l3 2q22 17 38 32t30 33 23 38 23 47q34 78 95 113t147 36q26 0 52-3t52-9v174q0 24-14 38t-39 14h-8q-5 0-9-2-157-51-286-147t-221-225-142-282-51-318q0-141 36-272t104-244 160-207 207-161T752 62t272-37z"></path></svg></div><div>View source</div></a><div class="w-[90%] xl:w-2/3"><div class="my-4"><div class="flex gap-10"></div><div class="flex overflow-hidden rounded-full bg-gray-300"></div></div></div></div></div><div class="max-w-full overflow-hidden"><div><div class="mb-8 w-full overflow-y-hidden overflow-x-scroll"><div><div role="tablist" aria-label="Details about the demo" class="ms-FocusZone css-106 ms-Pivot root-97" data-focuszone-id="FocusZone20"><button type="button" role="tab" aria-selected="true" id="Pivot19-Tab0" class="ms-Button ms-Button--action ms-Button--command ms-Pivot-link is-selected linkIsSelected-107" name="Overview" data-content="Overview" data-is-focusable="true"><span class="ms-Button-flexContainer flexContainer-108" data-automationid="splitbuttonprimary"><span class="ms-Pivot-linkContent linkContent-103"><span class="ms-Pivot-text text-104"> <!-- -->Overview</span></span></span></button><button type="button" role="tab" aria-selected="false" id="Pivot19-Tab1" class="ms-Button ms-Button--action ms-Button--command ms-Pivot-link link-115" name="Run locally" data-content="Run locally" data-is-focusable="true"><span class="ms-Button-flexContainer flexContainer-108" data-automationid="splitbuttonprimary"><span class="ms-Pivot-linkContent linkContent-103"><span class="ms-Pivot-text text-104"> <!-- -->Run locally</span></span></span></button><button type="button" role="tab" aria-selected="false" id="Pivot19-Tab2" class="ms-Button ms-Button--action ms-Button--command ms-Pivot-link link-115" name="One-click deploy to Azure" data-content="One-click deploy to Azure" data-is-focusable="true"><span class="ms-Button-flexContainer flexContainer-108" data-automationid="splitbuttonprimary"><span class="ms-Pivot-linkContent linkContent-103"><span class="ms-Pivot-text text-104"> <!-- -->One-click deploy to Azure</span></span></span></button><button type="button" role="tab" aria-selected="false" id="Pivot19-Tab3" class="ms-Button ms-Button--action ms-Button--command ms-Pivot-link link-115" name="Resources" data-content="Resources" data-is-focusable="true"><span class="ms-Button-flexContainer flexContainer-108" data-automationid="splitbuttonprimary"><span class="ms-Pivot-linkContent linkContent-103"><span class="ms-Pivot-text text-104"> <!-- -->Resources</span></span></span></button></div></div></div><div class="font-sans font-light"><div><h2 class="text-4xl">Overview</h2><div class="mt-5 mb-2"><h3 class="mb-1 font-sans font-semibold">About the app</h3><p>This is a sample application to demonstrate how to use Azure Web PubSub to livestream your code to others.</p></div><div class="mt-5 mb-2"><h3 class="mb-1 font-sans font-semibold">Azure Web PubSub enables</h3><ul class="ml-5 list-disc leading-5"><li class="mt-0">Real-time code editing</li></ul></div><h2 class="mt-12 text-4xl">How it works?</h2><div class="mt-5 mb-2"><h3 class="mb-1 font-sans font-semibold">Server side</h3>Serve a static web page <code>public/index.html</code> A REST API  <code>/negotiate</code> which returns a url to connect to Web PubSub<ul class="ml-5 list-disc"><li class="mt-0">Serve a static web page <code>public/index.html</code></li><li class="mt-0">A REST API <code>/negotiate</code> which returns a url to connect to Web PubSub</li></ul></div><div class="mt-5 mb-2"><h3 class="mb-1 font-sans font-semibold">Client side</h3><p>The most logic of this app is happening at client side. In client there&#x27;re two roles:</p><ul class="ml-5 list-disc"><li class="mt-0"><strong>Streamer</strong> <br>Streamer is the one who writes code and broadcasts to others. It uses <code>WebSocket.send()</code> to send the changes from the code editor (by hooking the editor.on(&#x27;change&#x27;) event) to a group (whose <code>ID</code> is generated in negotiate) in Azure Web PubSub. And for performance consideration, it buffers the changes and send them in a batch every 200 milliseconds. The main implementation can be found at  <code>startStream()</code> in <code>public/index.html</code>.</li><li class="mt-0"><strong>Watcher</strong> <br>Watcher is the one who watches streamer to code. It receives the changes from Azure Web PubSub and applies them one by one to the code editor (by calling the applyDelta() function). Since the changes is only a delta from the previous content there needs to be a way to get the full content from streamer when watcher is connected for the first time. So in this app when watcher is connected it will send a sync message to streamer (through another group called <code>id-control</code>) and streamer will send the full content to the group. The main implementation can be found at  <code>watch()</code> in <code>public/index.html</code>.</li></ul></div></div></div></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/azure-webpubsub/demos/tags/express-js">Express.js</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/azure-webpubsub/demos/metaverse"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Metaverse</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/azure-webpubsub/demos/chatr"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Chatr</div></a></nav></div></div></div></div></main></div></div></div>
<script src="/azure-webpubsub/assets/js/runtime~main.22eee77c.js"></script>
<script src="/azure-webpubsub/assets/js/main.5bbe748c.js"></script>
<script>document.addEventListener("keyup",(e=>{if("Tab"===e.key){const e=document.querySelector(".navbar-sidebar__back");e&&(e.style.display="none")}if("Escape"===e.key){document.querySelector(".navbar-sidebar__close").click()}})),window.addEventListener("resize",(()=>{const e=document.querySelector(".navbar-sidebar__back");e&&(e.style.display="none")}))</script></body>
</html>